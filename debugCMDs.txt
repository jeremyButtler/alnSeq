set confirm off
set confirm off
break hirschberg.c:112
break hirschberg.c:184
break hirschberg.c:465

define runcmd
  run -use-hirschberg -query test-query.fasta -ref test-ref.fasta
end

runcmd

# Print out the hirschberg reverse and forward score rows
define pscores
  printf "%3li", forwardIndelColL
  set $iIndex = 0

  while($iIndex < refLenUL)
    printf " %3li", *(forwardScoreRowL +refStartUL+$iIndex)
    set $iIndex = $iIndex + 1
  end

  printf "\n"
  set $iIndex = 0
 
  while($iIndex < refLenUL)
    printf "%3li ", *(reverseScoreRowL +refStartUL+$iIndex)
    set $iIndex = $iIndex + 1
  end

  printf "%3li\n", reverseIndelColL

  set $iIndex = 0
  set $sumI =  *(reverseScoreRowL + refStartUL)
  set $sumI = $sumI + forwardIndelColL

  printf "%3li ", $sumI

  while($iIndex < refLenUL - 1)
    set $sumI = *(forwardScoreRowL + refStartUL +$iIndex)
    set $iIndex = $iIndex + 1

    set $sumI=$sumI+*(reverseScoreRowL+refStartUL+$iIndex)
    printf "%3li ", $sumI
  end

  set $sumI =  *(forwardScoreRowL + refLenUL - 1)
  set $sumI = $sumI + reverseIndelColL

  printf "%3li\n", $sumI
end

# Quick function to get length of a string
define lenstr
  set $tmpStr = $arg0
  set $lenI = 0

  while(*$tmpStr != '\0')
    set $tmpStr = $tmpStr + 1
    set $lenI = $lenI + 1
  end

  p $lenI
end

#break hirschberg.c:464 if midPointUI - 1 + refOffsetUI < refOffsetUI
